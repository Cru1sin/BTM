import numpy as np

from scipy.interpolate import interp2d

# 给定的表格数据
m_clnt_vector = np.array([0.144, 0.180, 0.216])
T_air_vector = np.array([26, 27.5, 29, 30.5, 32, 33.5, 35, 36.5, 38, 39.5])

lamda1_table = np.array([
    [1.988324751, 1.889239264, 1.842938507],
    [1.978444579, 1.877619660, 1.828738850],
    [1.989446763, 1.859399307, 1.801127643],
    [1.969746279, 1.825205479, 1.787553581],
    [1.940503483, 1.816069251, 1.734998363],
    [1.906571584, 1.776929346, 1.716308498],
    [1.860278870, 1.753904107, 1.675273670],
    [1.821530550, 1.731725355, 1.655580165],
    [1.787459582, 1.706548340, 1.622780972],
    [1.733949773, 1.664400200, 1.594758875]
])

lamda2_table = np.array([
    [-0.000356529, -0.000306086, -0.000279761],
    [-0.000350255, -0.000299112, -0.000273089],
    [-0.000348191, -0.000291574, -0.000264591],
    [-0.000339876, -0.000281751, -0.000258731],
    [-0.000330907, -0.000276415, -0.000248186],
    [-0.000320016, -0.000267160, -0.000241717],
    [-0.000307654, -0.000260062, -0.000232916],
    [-0.000297712, -0.000253518, -0.000227059],
    [-0.000288486, -0.000247221, -0.000219845],
    [-0.000276553, -0.000238994, -0.00021368]
])

lamda3_table = np.array([
    [-7840.592905, -10394.45645, -12652.84826],
    [-7758.147964, -10189.16830, -12504.95541],
    [-7450.448531, -10106.29803, -12449.07209],
    [-7374.370321, -10192.70974, -12417.43227],
    [-7474.235640, -10042.63097, -12867.63314],
    [-7488.543099, -10225.86815, -12704.03159],
    [-7665.026122, -10203.87941, -12985.56924],
    [-7822.045366, -10177.38813, -12992.06274],
    [-7922.105114, -10274.06133, -13089.87120],
    [-8224.806160, -10595.63252, -13169.00374]
])

lamda4_table = np.array([
    [26.42555720, 29.54745462, 34.27084948],
    [24.91290644, 28.59343553, 32.75310248],
    [24.32623575, 27.69093620, 31.01591640],
    [23.18094191, 25.81150857, 29.81587231],
    [21.97665084, 25.37823663, 27.93585219],
    [21.33244436, 24.41982863, 27.06265417],
    [20.24473775, 23.67403869, 26.08857499],
    [19.55487237, 23.32483184, 25.54994155],
    [18.91226613, 22.29500056, 24.58311458],
    [18.02412939, 21.55706762, 23.9351684]
])

lamda5_table = np.array([
    [56358.19279, 59740.84703, 60585.78776],
    [55768.84387, 58566.37203, 59882.09524],
    [53570.54124, 58089.87485, 59612.78778],
    [53022.97564, 58577.68579, 59458.89948],
    [53730.99985, 57715.33569, 61596.93226],
    [53829.40117, 58760.40612, 60816.60215],
    [55083.19408, 58630.90577, 62152.29327],
    [56200.08998, 58476.56683, 62181.02537],
    [56909.54061, 59024.31527, 62642.32069],
    [59063.38509, 60855.90540, 63017.28218]
])

lamda6_table = np.array([
    [-4723.334273, -6218.718263, -7576.902512],
    [-4715.082712, -6143.229516, -7544.744757],
    [-4596.847513, -6123.621565, -7520.463680],
    [-4568.193666, -6155.276328, -7526.586642],
    [-4624.944505, -6096.314586, -7733.972597],
    [-4642.673577, -6204.445836, -7673.674188],
    [-4722.235131, -6203.143626, -7809.485277],
    [-4806.465945, -6208.704376, -7836.583386],
    [-4858.858460, -6257.975420, -7878.040565],
    [-4990.538277, -6412.729674, -7934.525651]
])

# 使用 interp2d 进行插值
interp_lamda1 = interp2d(m_clnt_vector, T_air_vector, lamda1_table, kind='linear')
interp_lamda2 = interp2d(m_clnt_vector, T_air_vector, lamda2_table, kind='linear')
interp_lamda3 = interp2d(m_clnt_vector, T_air_vector, lamda3_table, kind='linear')
interp_lamda4 = interp2d(m_clnt_vector, T_air_vector, lamda4_table, kind='linear')
interp_lamda5 = interp2d(m_clnt_vector, T_air_vector, lamda5_table, kind='linear')
interp_lamda6 = interp2d(m_clnt_vector, T_air_vector, lamda6_table, kind='linear')


# 设定插值点
m_clnt_val = 0.18
T_air_val = 30

# 计算 lambda1
lambda1 = interp_lamda1(m_clnt_val, T_air_val)[0]

# 设定其他变量值
P_comp = 500  # W
T_clnt_out = 35  # ℃
T_amb = 30  # ℃
m_air = 1.2  # kg/s
m_clnt = 0.18  # kg/s

# 计算 Q_cooling (假设 lambda2~lambda6 也已插值得到)
lambda2 = -0.0003
lambda3 = -10100
lambda4 = 25
lambda5 = 58000
lambda6 = -6000

Q_cooling = (lambda1 * P_comp + lambda2 * P_comp**2 + lambda3 * T_clnt_out +
             lambda4 * T_amb * m_air + lambda5 * T_clnt_out * m_clnt + lambda6)

print(f"冷却功率 Q_cooling = {Q_cooling:.2f} W")